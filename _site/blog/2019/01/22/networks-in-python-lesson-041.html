<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>lessons on networks in python 041 | x.merge(y.merge(x))</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="lessons on networks in python 041" />
<meta name="author" content="dc" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="a short HTTPclient in python" />
<meta property="og:description" content="a short HTTPclient in python" />
<link rel="canonical" href="http://localhost:4000/blog/2019/01/22/networks-in-python-lesson-041.html" />
<meta property="og:url" content="http://localhost:4000/blog/2019/01/22/networks-in-python-lesson-041.html" />
<meta property="og:site_name" content="x.merge(y.merge(x))" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-22T00:00:00+01:00" />
<script type="application/ld+json">
{"description":"a short HTTPclient in python","author":{"@type":"Person","name":"dc"},"@type":"BlogPosting","url":"http://localhost:4000/blog/2019/01/22/networks-in-python-lesson-041.html","headline":"lessons on networks in python 041","dateModified":"2019-01-22T00:00:00+01:00","datePublished":"2019-01-22T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2019/01/22/networks-in-python-lesson-041.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="x.merge(y.merge(x))" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">x.merge(y.merge(x))</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">about</a><a class="page-link" href="/blog.html">blog</a><a class="page-link" href="/downloads.html">downloads</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">lessons on networks in python 041</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-01-22T00:00:00+01:00" itemprop="datePublished">Jan 22, 2019
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">dc</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>The urllib is really powerful. It can wrap your input data in headers and send them off to a server as properly formatted html request objects at a remote host. Saying this entails that we distinguish between the concept of a host and a server. Whereas a host is the suite of protocols that define the goals of a target operating system, a server is a program that runs on a host. Many people do not make this distinction. They do not realize that their pcs and smartphones can be configured to run as server apps. This should not be surprising, given the news about hacking and all, but it may seem surprising to some. For those of you who are concerned that your computer is participating in computations not under your control, I have to say, I sympathize with you, but <em>I DO plan to inspect all of the code that runs on my pc all of the time!</em> It’s just that sometimes … deadlines.</p>

<p>Ok, now check out some cool program code:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>
<span class="c"># Adapted from ...</span>
<span class="c"># https://www.packtpub.com/networking-and-servers/python-network-programming-cookbook-second-edition</span>
<span class="c"># Python 3.7</span>
<span class="c"># download_data.py</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="n">REMOTE_SERVER_HOST</span> <span class="o">=</span> <span class="s">'http://www.cnn.com'</span>

<span class="k">class</span> <span class="nc">HTTPClient</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>

    <span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">text</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">'HTTP Client Example'</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--host'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">"store"</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">"host"</span><span class="p">,</span>  <span class="n">default</span><span class="o">=</span><span class="n">REMOTE_SERVER_HOST</span><span class="p">)</span>
    <span class="n">given_args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">host</span> <span class="o">=</span> <span class="n">given_args</span><span class="o">.</span><span class="n">host</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">HTTPClient</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">fetch</span><span class="p">())</span>
</code></pre></div></div>

<p>This program basically does something like,</p>

<p>Step 1. Fetch some utf-8 symbols from the host, http://www.cnn.com.
  Step 2. Decode the utf-8 symbols and print them in ascii characters on the standard output</p>

<p>Try running it for yourself.</p>

<p>It will give you some interesting stuff to read in the terminal. You can also try it with some parameters.</p>

<p>It works like this,</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python download_data.py --host=http://www.danjcook.com/blog/2019-01-22-networks-in-python-lesson-041
</code></pre></div></div>

<p>Did you see that ?</p>

<p>I wonder if there’s anything valuable in scrapping that data on a timely basis? Anybody wanna clean it?</p>

<p>Anyway, as I said, the urllib library is pretty powerful.</p>

<p>The program constructs an HTTPClient class. An instance of the class assigns to itself a name corresponding to an ip address of a remote host, REMOTE_SERVER_HOST. The client then has a single method that does all of the things we mentioned at the outset of the lesson. It constructs http headers, and sends them off to a server as properly formatted requests for html at the remote host. On the receiving end, it receives replies from the server of the data. Note that state changes triggered in the server app running on the host may have resulted in a complex interplay of several different peices of technology, but we do not know this. It is transparent to us.</p>

<p>Thus, we will have to follow up in the future by showing how to request from the remote host their credentials. We can then use this information to make decisions about the soundness of the response.</p>

<p>Dan’s Honorable Python Libaries, Classes, and Functions<br />
urllib.request.urlopen(host)</p>

  </div><a class="u-url" href="/blog/2019/01/22/networks-in-python-lesson-041.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">x.merge(y.merge(x))</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">x.merge(y.merge(x))</li><li><a class="u-email" href="mailto:cookdj0128@gmail.com">cookdj0128@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/dnck"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">dnck</span></a></li><li><a href="https://www.linkedin.com/in/danjohncook"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">danjohncook</span></a></li><li><a href="https://www.twitter.com/dan_j_cook"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">dan_j_cook</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>The personal homepage of Daniel John Cook.</p>
      </div>
    </div>

  </div>


</footer>
</body>

</html>
